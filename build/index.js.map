{"version":3,"file":"index.js","sources":["../source/index.ts"],"sourcesContent":["import { regex as period } from 'vamtiger-regex-period';\nimport { ReferenceObjectPath } from 'vamtiger-reference-object-path';\n\nconst referenceObjectPath = require('vamtiger-reference-object-path') as ReferenceObjectPath;\n\nconst periodCharacter = '.';\n\nexport default function main({ path: requirePath, constructorParams, arguments: args, instanceArguments: instanceArgs, instanceAttribute, instanceMethod, instancePath, requireArguments }: Params) {\n    const [filePath, ...objectPaths] = requirePath.split(period);\n    const objectPath = objectPaths && objectPaths.join(periodCharacter);\n    const requiredModule = require(filePath);\n    const method = objectPath && referenceObjectPath({\n        object: requiredModule,\n        path: objectPath\n    });\n\n    let result = method || requiredModule;\n    let resultFunction;\n\n    instanceMethod = instanceMethod || instancePath;\n    args = requireArguments && getRequiredArguments({ requireArguments }) || args;\n\n    if (constructorParams) {\n        result = new result(constructorParams);\n\n        if (instanceMethod) {\n            resultFunction = referenceObjectPath({\n                object: result,\n                path: instanceMethod\n            });\n\n            result = resultFunction.apply(result, args || []);\n        } else if (instanceAttribute)\n            result = result[instanceAttribute];\n    } else if (args && typeof args[args.length - 1] === Type.function)\n        result = result.apply(null, args);\n    else if (args)\n        result = result(args);\n\n    return result;\n}\n\nfunction getRequiredArguments({ requireArguments }: GetRequiredArgumentsParams) {\n    const requiredArguments = requireArguments\n        .map(argument => typeof argument === 'string' ? { path: argument } : argument)\n        .map(main);\n\n    return requiredArguments;\n}\n\nexport interface Params {\n    path: string;\n    constructorParams?: AnyObject;\n    instanceAttribute?: string;\n    instanceMethod?: string;\n    instancePath?: string; // alias for instanceMethod\n    arguments?: any[];\n    requireArguments?: string[];\n    instanceArguments?: any[];\n}\n\ninterface GetRequiredArgumentsParams {\n    requireArguments: Params['requireArguments'];\n}\n\nexport enum Type {\n    function = 'function'\n}\n\nexport type AnyObject = {\n    [key: string]: any;\n}\n\nexport type VamtigerRequire = typeof main;"],"names":["referenceObjectPath","require","periodCharacter","main","path","requirePath","constructorParams","arguments","args","instanceArguments","instanceArgs","instanceAttribute","instanceMethod","instancePath","requireArguments","filePath","objectPaths","split","period","objectPath","join","requiredModule","resultFunction","result","object","getRequiredArguments","apply","length","Type","function","map","argument"],"mappings":"6HAGA,MAAMA,oBAAsBC,QAAQ,kCAE9BC,gBAAkB,IAExB,SAAwBC,MAAOC,KAAMC,EAAWC,kBAAEA,EAAmBC,UAAWC,EAAMC,kBAAmBC,EAAYC,kBAAEA,EAAiBC,eAAEA,EAAcC,aAAEA,EAAYC,iBAAEA,IACpK,MAAOC,KAAaC,GAAeX,EAAYY,MAAMC,2BAC/CC,EAAaH,GAAeA,EAAYI,KAAKlB,iBAC7CmB,EAAiBpB,QAAQc,GAM/B,IACIO,EADAC,EALWJ,GAAcnB,qBACzBwB,OAAQH,EACRjB,KAAMe,KAGaE,EAuBvB,OApBAT,EAAiBA,GAAkBC,EACnCL,EAAOM,GAAoBW,sBAAuBX,iBAAAA,KAAuBN,EAErEF,GACAiB,EAAS,IAAIA,EAAOjB,GAEhBM,EAMAW,GALAD,EAAiBtB,qBACbwB,OAAQD,EACRnB,KAAMQ,KAGcc,MAAMH,EAAQf,OAC/BG,IACPY,EAASA,EAAOZ,KACbH,UAAeA,EAAKA,EAAKmB,OAAS,KAAOC,aAAKC,SACrDN,EAASA,EAAOG,MAAM,KAAMlB,GACvBA,IACLe,EAASA,EAAOf,IAEbe,EAGX,SAASE,sBAAqBX,iBAAEA,IAK5B,OAJ0BA,EACrBgB,IAAIC,GAAgC,iBAAbA,GAA0B3B,KAAM2B,GAAaA,GACpED,IAAI3B,OAoBDyB,eAAAA"}